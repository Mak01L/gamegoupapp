(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{7328:function(e,t,r){Promise.resolve().then(r.bind(r,1176))},1176:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(7437),a=r(2265),n=r(3303),o=r(9376),l=r(3145),i=r(1265),u=r(3949);function c(){let{t:e}=(0,u.$G)("auth"),[t,r]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[g,x]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!0),[f,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[I,S]=(0,a.useState)(""),[E,k]=(0,a.useState)(!1),O=(0,o.useRouter)(),{user:C}=(0,i.a)();(0,a.useEffect)(()=>{C&&O.push("/dashboard")},[C,O]),(0,a.useEffect)(()=>{{let e=localStorage.getItem("gamegoup_email"),t=localStorage.getItem("gamegoup_password");e&&t&&(r(e),d(t),x(!0))}},[]);let _=async r=>{r.preventDefault(),N(""),y(""),k(!0);try{if(p){g?(localStorage.setItem("gamegoup_email",t),localStorage.setItem("gamegoup_password",c)):(localStorage.removeItem("gamegoup_email"),localStorage.removeItem("gamegoup_password"));let{error:e}=await n.O.auth.signInWithPassword({email:t,password:c});e&&N(e.message)}else{if(!I.trim()){N(e("errors.usernameRequired"));return}if(c!==h){N(e("errors.passwordsDontMatch"));return}if(c.length<6){N(e("errors.passwordTooShort"));return}let{data:r,error:s}=await n.O.auth.signUp({email:t,password:c,options:{data:{username:I}}});s?N(s.message):((null==r?void 0:r.user)&&await n.O.auth.updateUser({data:{username:I}}),y(e("signupSuccess")),b(!0))}}catch(t){N(e("errors.unexpectedError")),console.error("Auth error:",t)}finally{k(!1)}},P=async r=>{r.preventDefault(),N(""),y(""),k(!0);try{let{error:r}=await n.O.auth.resetPasswordForEmail(t);r?N(r.message):y(e("resetEmailSent"))}catch(t){N(e("errors.unexpectedError")),console.error("Reset error:",t)}finally{k(!1)}};return C?(0,s.jsxs)("main",{className:"min-h-screen flex flex-col items-center justify-center",children:["        ",(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-violet-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-300",children:e("redirectingToDashboard")})]})]}):(0,s.jsxs)("main",{className:"min-h-screen flex flex-col items-center justify-center",children:["      ",(0,s.jsx)("div",{className:"w-full flex flex-col items-center justify-center mt-8 mb-4",children:(0,s.jsx)(l.default,{src:"/logo.png",alt:"GameGoUp Logo",width:320,height:320,priority:!0,className:"w-80 h-80",sizes:"320px"})}),(0,s.jsx)("h1",{className:"text-3xl font-bold mb-4 text-violet-400",children:f?e("resetPassword"):p?e("loginTitle"):e("signupTitle")}),(0,s.jsxs)("form",{onSubmit:f?P:_,className:"flex flex-col gap-3 w-80 bg-neutral-900 p-6 rounded-xl border border-violet-700",children:["        ",!p&&!f&&(0,s.jsx)("input",{type:"text",placeholder:e("username"),className:"p-2 rounded bg-black border border-violet-500 text-white",value:I,onChange:e=>S(e.target.value),required:!0,maxLength:20}),"        ",(0,s.jsx)("input",{type:"email",placeholder:e("email"),className:"p-2 rounded bg-black border border-violet-500 text-white",value:t,onChange:e=>r(e.target.value),required:!0}),!f&&(0,s.jsxs)(s.Fragment,{children:["            ",(0,s.jsx)("input",{type:"password",placeholder:e("password"),className:"p-2 rounded bg-black border border-violet-500 text-white",value:c,onChange:e=>d(e.target.value),required:!0}),!p&&(0,s.jsx)("input",{type:"password",placeholder:e("confirmPassword"),className:"p-2 rounded bg-black border border-violet-500 text-white",value:h,onChange:e=>m(e.target.value),required:!0}),p&&(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-violet-300",children:[(0,s.jsx)("input",{type:"checkbox",checked:g,onChange:e=>x(e.target.checked)}),e("remember")]})]}),w&&(0,s.jsx)("div",{className:"text-red-400 text-sm",children:w}),j&&(0,s.jsx)("div",{className:"text-green-400 text-sm",children:j}),"        ",(0,s.jsxs)("button",{type:"submit",className:"bg-red-600 hover:bg-red-700 disabled:bg-red-800 disabled:cursor-not-allowed text-white py-2 rounded-xl font-bold flex items-center justify-center gap-2 transition-colors border-2 border-red-500 hover:border-red-400",disabled:E,children:[E&&(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"          ",E?e("loggingIn"):f?e("sendResetLink"):p?e("loginButton"):e("signupButton")]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 mt-2",children:["          ",!f&&(0,s.jsx)("button",{type:"button",className:"text-red-400 hover:underline text-sm border border-red-400 rounded px-2 py-1 hover:bg-red-400 hover:text-white transition-colors",onClick:()=>{b(!p),N(""),y("")},children:p?e("switchToSignup"):e("switchToLogin")}),(0,s.jsx)("button",{type:"button",className:"text-red-400 hover:underline text-sm border border-red-400 rounded px-2 py-1 hover:bg-red-400 hover:text-white transition-colors",onClick:()=>{v(!f),N(""),y("")},children:f?e("backToLogin"):e("forgotPassword")})]})]})]})}},1265:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return u}});var s=r(7437),a=r(2265),n=r(3303),o=r(9376),l=r(3949);let i=(0,a.createContext)(void 0);function u(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:t}=e,{t:r}=(0,l.$G)("common"),[u,c]=(0,a.useState)(null),[d,h]=(0,a.useState)(!0),m=(0,o.useRouter)(),g=(0,o.usePathname)(),x=["/auth"];(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e},error:t}=await n.O.auth.getUser();t?(console.error("Error getting user:",t),c(null)):c(e)}catch(e){console.error("Error in getInitialUser:",e),c(null)}finally{h(!1)}})();let{data:{subscription:e}}=n.O.auth.onAuthStateChange(async(e,t)=>{var r,s;console.log("Auth state changed:",e,null==t?void 0:null===(r=t.user)||void 0===r?void 0:r.id),"SIGNED_IN"===e||"TOKEN_REFRESHED"===e?(c(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),("/auth"===g||"/"===g)&&m.push("/dashboard")):"SIGNED_OUT"===e&&(c(null),m.push("/auth")),h(!1)});return()=>{e.unsubscribe()}},[m,g]),(0,a.useEffect)(()=>{if(!d){let e=x.includes(g);u||e?u&&"/auth"===g?m.push("/dashboard"):u&&"/"===g&&m.push("/dashboard"):m.push("/auth")}},[u,d,g,m]);let p=async()=>{try{h(!0);let{error:e}=await n.O.auth.signOut();e&&console.error("Error signing out:",e)}catch(e){console.error("Error in signOut:",e)}finally{h(!1)}};return d?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-black",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-violet-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white text-lg",children:r("loading.general")})]})}):u||x.includes(g)?(0,s.jsx)(i.Provider,{value:{user:u,loading:d,signOut:p},children:t}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-black",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-white text-lg",children:"Redirigiendo..."})})})}},3303:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});let s=(0,r(3288).eI)("https://hjgsgockrrnnprpddpsa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhqZ3Nnb2NrcnJubnBycGRkcHNhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2OTM2MDIsImV4cCI6MjA2NDI2OTYwMn0.uVhGqEllYz-PmIiizI0DE35Ov0M8CtnurLZp_z2DKEU")},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[631,145,971,117,744],function(){return e(e.s=7328)}),_N_E=e.O()}]);